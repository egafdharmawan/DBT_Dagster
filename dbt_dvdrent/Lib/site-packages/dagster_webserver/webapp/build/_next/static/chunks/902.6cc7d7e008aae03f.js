(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[902],{72215:function(t,n,e){"use strict";e.d(n,{h5:function(){return linkHorizontal}});var r=e(91672),o=e(72299),i=e(33554),a=e(11053);function linkSource(t){return t.source}function linkTarget(t){return t.target}function curveHorizontal(t,n,e,r,o){t.moveTo(n,e),t.bezierCurveTo(n=(n+r)/2,e,n,o,r,o)}function linkHorizontal(){return function(t){var n=linkSource,e=linkTarget,u=a.x,d=a.y,s=null;function link(){var i,a=o.t.call(arguments),l=n.apply(this,a),c=e.apply(this,a);if(s||(s=i=(0,r.Z)()),t(s,+u.apply(this,(a[0]=l,a)),+d.apply(this,a),+u.apply(this,(a[0]=c,a)),+d.apply(this,a)),i)return s=null,i+""||null}return link.source=function(t){return arguments.length?(n=t,link):n},link.target=function(t){return arguments.length?(e=t,link):e},link.x=function(t){return arguments.length?(u="function"==typeof t?t:(0,i.Z)(+t),link):u},link.y=function(t){return arguments.length?(d="function"==typeof t?t:(0,i.Z)(+t),link):d},link.context=function(t){return arguments.length?(s=null==t?null:t,link):s},link}(curveHorizontal)}},30733:function(t,n,e){var r=e(96738);function memoize(t,n){if("function"!=typeof t||null!=n&&"function"!=typeof n)throw TypeError("Expected a function");var memoized=function(){var e=arguments,r=n?n.apply(this,e):e[0],o=memoized.cache;if(o.has(r))return o.get(r);var i=t.apply(this,e);return memoized.cache=o.set(r,i)||o,i};return memoized.cache=new(memoize.Cache||r),memoized}memoize.Cache=r,t.exports=memoize},56612:function(t,n,e){"use strict";function _array_like_to_array(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function _unsupported_iterable_to_array(t,n){if(t){if("string"==typeof t)return _array_like_to_array(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);if("Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e)return Array.from(e);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return _array_like_to_array(t,n)}}function _sliced_to_array_sliced_to_array(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e,r,o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i=[],a=!0,u=!1;try{for(o=o.call(t);!(a=(e=o.next()).done)&&(i.push(e.value),!n||i.length!==n);a=!0);}catch(t){u=!0,r=t}finally{try{a||null==o.return||o.return()}finally{if(u)throw r}}return i}}(t,n)||_unsupported_iterable_to_array(t,n)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r=e(46506);function _to_consumable_array_to_consumable_array(t){return function(t){if(Array.isArray(t))return _array_like_to_array(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||_unsupported_iterable_to_array(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o=e(41059),i=e(30733),a=e.n(i);e(77105),e(2784);var u=a()(function(){return function(t){var n=void 0;try{if(n=window.localStorage.getItem(t))return JSON.parse(n)}catch(t){if("string"==typeof n)return n;return}}("DAGSTER_FLAGS")||[]});a()(function(t){return u().includes(t)}),a()(function(t){return new Intl.NumberFormat(t,{minimumFractionDigits:3,maximumFractionDigits:3})}),new Intl.Collator(navigator.language,{sensitivity:"base"}),(0,o.H)({source:function(t){return t.source},target:function(t){return t.target},x:function(t){return t.x},y:function(t){return t.y}});var groupIdForNode=function(t){return[t.definition.repository.name,"@",t.definition.repository.location.name,":",t.definition.groupName].join("")},d=a()(function(t,n){var e=Object.keys(n.upstream[JSON.stringify(t.path)]||{}).map(function(t){return{path:JSON.parse(t),__typename:"AssetKey"}});return[t].concat(_to_consumable_array_to_consumable_array(e),_to_consumable_array_to_consumable_array(e.map(function(t){return d(t,n)}).flat())).filter(function(t,n,e){return e.findIndex(function(n){return JSON.stringify(n)===JSON.stringify(t)})===n})},function(t,n){return JSON.stringify({key:t,data:n})}),layoutAssetGraph=function(t,n){var e=new r.graphlib.Graph({compound:!0}),o="tight-tree";e.setGraph(n.horizontalDAGs?{rankdir:"LR",marginx:100,marginy:100,nodesep:-10,edgesep:90,ranksep:60,ranker:o}:{rankdir:"TB",marginx:100,marginy:100,nodesep:40,edgesep:10,ranksep:10,ranker:o}),e.setDefaultEdgeLabel(function(){return{}});var shouldRender=function(t){return t},i=Object.values(t.nodes).filter(shouldRender),a=t.expandedGroups||[],u={},d=!0,s=!1,l=void 0;try{for(var c,h=i[Symbol.iterator]();!(d=(c=h.next()).done);d=!0){var f=c.value;if(f.definition.groupName){var p=groupIdForNode(f);u[p]=u[p]||{id:p,expanded:a.includes(p),groupName:f.definition.groupName,repositoryName:f.definition.repository.name,repositoryLocationName:f.definition.repository.location.name,bounds:{x:0,y:0,width:0,height:0}}}}}catch(t){s=!0,l=t}finally{try{d||null==h.return||h.return()}finally{if(s)throw l}}var y=Object.keys(u).length>1;y&&Object.keys(u).forEach(function(t){a.includes(t)?e.setNode(t,{}):e.setNode(t,{width:270,height:110})}),i.forEach(function(t){(!y||a.includes(groupIdForNode(t)))&&(e.setNode(t.id,getAssetNodeDimensions(t.definition)),y&&t.definition.groupName&&e.setParent(t.id,groupIdForNode(t)))});var m={},g=Object.fromEntries(Object.entries(t.nodes).map(function(t){var n=_sliced_to_array_sliced_to_array(t,2);return[n[0],groupIdForNode(n[1])]}));Object.entries(t.downstream).forEach(function(n){var r=_sliced_to_array_sliced_to_array(n,2),o=r[0];Object.keys(r[1]).forEach(function(n){if(shouldRender(t.nodes[n])||shouldRender(t.nodes[o])){var r=o,i=n,u=g[n];y&&u&&!a.includes(u)&&(i=u);var d=g[o];y&&d&&!a.includes(d)&&(r=d),r!==i&&(e.setEdge({v:r,w:i},{weight:1}),shouldRender(t.nodes[n])?shouldRender(t.nodes[o])||(m[o]=!0):m[n]=!0)}})}),Object.keys(m).forEach(function(t){var r=JSON.parse(t),o=r[r.length-1]||"";e.setNode(t,getAssetLinkDimensions(o,n))}),r.layout(e);var v=1,x=1,b={};if(e.nodes().forEach(function(t){var n=e.node(t);if((null==n?void 0:n.x)&&(null==n?void 0:n.width)){var r={x:n.x-n.width/2,y:n.y-n.height/2,width:n.width,height:n.height};/^[^@:]+@[^@:]+:[^@:]+$/.test(t)?a.includes(t)||(u[t].bounds=r):b[t]={id:t,bounds:r},v=Math.max(v,n.x+n.width/2),x=Math.max(x,n.y+n.height/2)}}),y){var _=!0,w=!1,O=void 0;try{for(var k,E=i[Symbol.iterator]();!(_=(k=E.next()).done);_=!0){var N=k.value,I=b[N.id];if(I&&N.definition.groupName){var S=u[groupIdForNode(N)];S.bounds=0===S.bounds.width?I.bounds:extendBounds(S.bounds,I.bounds)}}}catch(t){w=!0,O=t}finally{try{_||null==E.return||E.return()}finally{if(w)throw O}}var A=!0,M=!1,j=void 0;try{for(var z,D=Object.values(u)[Symbol.iterator]();!(A=(z=D.next()).done);A=!0){var B=z.value;B.expanded&&(B.bounds=padBounds(B.bounds,{x:15,top:65,bottom:-15}))}}catch(t){M=!0,j=t}finally{try{A||null==D.return||D.return()}finally{if(M)throw j}}}var G=[];return e.edges().forEach(function(t){var r=e.node(t.v),o=e.node(t.w);if(r&&o){var i=m[t.v]?16:24,a=m[t.w]?16:24;G.push(n.horizontalDAGs?{from:{x:r.x+r.width/2,y:r.y},fromId:t.v,to:{x:o.x-o.width/2-5,y:o.y},toId:t.w}:{from:{x:r.x-r.width/2+i,y:r.y-30+r.height/2},fromId:t.v,to:{x:o.x-o.width/2+a,y:o.y+20-o.height/2},toId:t.w})}}),{nodes:b,edges:G,width:v+100,height:x+100,groups:y?u:{}}},getAssetLinkDimensions=function(t,n){return n.horizontalDAGs?{width:32+8*Math.min(10,t.length),height:90}:{width:106,height:90}},padBounds=function(t,n){return{x:t.x-n.x,y:t.y-n.top,width:t.width+2*n.x,height:t.height+n.top+n.bottom}},extendBounds=function(t,n){var e=Math.min(t.x,n.x),r=Math.min(t.y,n.y);return{x:e,y:r,width:Math.max(t.x+t.width,n.x+n.width)-e,height:Math.max(t.y+t.height,n.y+n.height)-r}},getAssetNodeDimensions=function(t){var n=100;return t.isSource&&t.isObservable?n+=30:t.isSource?n+=0:(n+=26,t.isPartitioned&&(n+=40)),{width:265,height:n+=30}},titleOfIO=function(t){return"result"!==t.solid.name?"".concat(t.solid.name,":").concat(t.definition.name):t.solid.name};function flattenIO(t){var n={};return t.forEach(function(t){return t.forEach(function(t){return n[titleOfIO(t)]=t})}),Object.values(n)}function layoutExternalConnections(t,n,e){var r=e-166,o=Math.max(200,r/t.length),i=83+Math.min(0,(r-t.length*o)/2),a=o<300?20:0,u={};return t.forEach(function(t,e){u[titleOfIO(t)]={x:i+e*o,y:n+a*(1-e%2*2)}}),u}function layoutOp(t,n){var e=n.y,appendMiniIODots=function(t,r,o){var i,a=_to_consumable_array_to_consumable_array(t).sort(function(t,n){return r(t).localeCompare(r(n))}),u=0,d=null,s={},l=Math.min(35,370/(a.length+1));a.forEach(function(t,r){var a=o(t);a!==d?(d=a,i={port:{x:n.x+u+13,y:e+13},collapsed:[],label:!1,layout:{x:n.x+u,y:e,width:35,height:26}},s[t.definition.name]=i,u+=l):(0===i.collapsed.length&&(u+=15),i.collapsed.push(t.definition.name))});var c=(370-(u-13+35))/2;return Object.values(s).forEach(function(t){t.layout.x+=c,t.port.x+=c}),e+=26,s},appendStackedIOBoxes=function(t){var r={};return t.forEach(function(t){r[t.definition.name]={port:{x:n.x+13,y:e+13},label:!0,collapsed:[],layout:{x:n.x,y:e,width:0,height:26}},e+=26}),r},r=t.inputs.length>4?appendMiniIODots(t.inputs,function(t){return t.definition.name},function(t){var n;return(null===(n=t.dependsOn[0])||void 0===n?void 0:n.solid.name)||""}):appendStackedIOBoxes(t.inputs),o={x:n.x,y:Math.max(n.y,e-0),width:370,height:52};e+=52,t.definition.assetNodes.length&&t.definition.description&&(o.height+=22,e+=22);var i=t.outputs.length>4?appendMiniIODots(t.outputs,function(t){var n;return(null===(n=t.dependedBy[0])||void 0===n?void 0:n.definition.name)||""},function(t){var n;return(null===(n=t.dependedBy[0])||void 0===n?void 0:n.solid.name)||""}):appendStackedIOBoxes(t.outputs);return{bounds:{x:n.x-5,y:n.y-5,width:380,height:e-n.y+10},op:o,inputs:r,outputs:i}}self.addEventListener("message",function(t){var n=t.data;switch(n.type){case"layoutOpGraph":var e,o,i,a,u,d,s,l,c,h,f,p,y,m,g,v=n.ops,x=n.opts;self.postMessage((u=new r.graphlib.Graph,d=0,s=100,l=100,x.parentOp&&(s=(l=140)+(d=26*Math.max(x.parentOp.inputs.length,x.parentOp.outputs.length))),u.setGraph({rankdir:"TB",marginx:l,marginy:s,ranker:"tight-tree"}),u.setDefaultEdgeLabel(function(){return{}}),c=[],h={},v.forEach(function(t){h[t.name]=!0}),v.forEach(function(t){var n=layoutOp(t,{x:0,y:0});u.setNode(t.name,{width:n.bounds.width,height:n.bounds.height}),t.inputs.forEach(function(n){n.dependsOn.forEach(function(e){h[e.solid.name]&&h[t.name]&&(u.setEdge({v:e.solid.name,w:t.name},{weight:1}),c.push({from:{point:{x:0,y:0},opName:e.solid.name,edgeName:e.definition.name},to:{point:{x:0,y:0},opName:t.name,edgeName:n.definition.name}}))})})}),r.layout(u),f={},p={},u.nodes().forEach(function(t){var n=u.node(t);n&&(p[t]=n)}),y=0,m=0,Object.entries(p).forEach(function(t){var n=_sliced_to_array_sliced_to_array(t,2),e=n[0],r=n[1],o=v.find(function(t){return t.name===e});if(o){var i=r.x-r.width/2,a=r.y-r.height/2;f[e]=layoutOp(o,{x:i,y:a}),y=Math.max(y,i+r.width),m=Math.max(m,a+r.height)}}),u.edges().forEach(function(t){var n=c.find(function(n){return n.from.opName===t.v&&n.to.opName===t.w}),e=u.edge(t).points;n&&e.length>0&&(n.from.point=e[0],n.to.point=e[e.length-1])}),g={edges:c,nodes:f,width:y+l,height:m+s,parent:null},x.parentOp&&(g.parent=(e=x.parentOp,o=d,a=(i={invocationBoundingBox:{x:1,y:1,width:g.width-1,height:g.height-1},bounds:{x:70,y:70+o,width:g.width-140,height:g.height-(70+o)*2},mappingLeftEdge:50,mappingLeftSpacing:10,inputs:{},outputs:{},dependsOn:layoutExternalConnections(flattenIO(e.inputs.map(function(t){return t.dependsOn})),-50,g.width),dependedBy:layoutExternalConnections(flattenIO(e.outputs.map(function(t){return t.dependedBy})),g.height+50,g.width)}).bounds.y+i.bounds.height,e.inputs.forEach(function(t,n){i.inputs[t.definition.name]={layout:{x:i.bounds.x,y:i.bounds.y-26*n-26,width:0,height:26},collapsed:[],label:!0,port:{x:i.bounds.x+13,y:i.bounds.y-26*n-13}}}),e.outputs.forEach(function(t,n){i.outputs[t.definition.name]={layout:{x:i.bounds.x,y:a+26*n,width:0,height:26},collapsed:[],label:!0,port:{x:i.bounds.x+13,y:a+26*n+13}}}),i)),g));break;case"layoutAssetGraph":var b=n.graphData,_=n.opts;self.postMessage(layoutAssetGraph(b,_))}})}}]);
//# sourceMappingURL=902.6cc7d7e008aae03f.js.map